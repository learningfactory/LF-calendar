<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Calendar OAuth Ïó∞Îèô</title>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/google-calendar@5.11.3/main.global.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script> <!-- Google OAuth -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css">
</head>
<body>
    <h2>üìÖ ÎÇ¥ Ï∫òÎ¶∞Îçî</h2>
    <button id="authorize_button">Google Î°úÍ∑∏Ïù∏</button>
    <button id="signout_button" style="display:none;">Î°úÍ∑∏ÏïÑÏõÉ</button>
    <div id="calendar"></div>

    <script>
        let CLIENT_ID = "236715550382-tq8n97cch62bo3jcvuflmij6rj3ab0qp.apps.googleusercontent.com"; // Google CloudÏóêÏÑú Î∞úÍ∏âÎ∞õÏùÄ OAuth ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ID
        let API_KEY = "YOUR_API_KEY"; // API ÌÇ§ (ÌïÑÏöîÌïòÎ©¥ Ï∂îÍ∞Ä)
        let SCOPES = "https://www.googleapis.com/auth/calendar.readonly"; // ÏùΩÍ∏∞ Ï†ÑÏö© Í∂åÌïú

        document.addEventListener('DOMContentLoaded', function() {
            let calendarEl = document.getElementById('calendar');
            let authorizeButton = document.getElementById("authorize_button");
            let signoutButton = document.getElementById("signout_button");

            function handleAuthClick() {
                gapi.auth2.getAuthInstance().signIn();
            }

            function handleSignoutClick() {
                gapi.auth2.getAuthInstance().signOut();
            }

            function initClient() {
                gapi.client.init({
                    apiKey: API_KEY,
                    clientId: CLIENT_ID,
                    discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],
                    scope: SCOPES
                }).then(() => {
                    gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
                    updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
                    authorizeButton.onclick = handleAuthClick;
                    signoutButton.onclick = handleSignoutClick;
                });
            }

            function updateSigninStatus(isSignedIn) {
                if (isSignedIn) {
                    authorizeButton.style.display = "none";
                    signoutButton.style.display = "block";
                    loadCalendar();
                } else {
                    authorizeButton.style.display = "block";
                    signoutButton.style.display = "none";
                }
            }

            function loadCalendar() {
                let calendar = new FullCalendar.Calendar(calendarEl, {
                    initialView: 'timeGridWeek',
                    slotMinTime: '09:00:00',
                    slotMaxTime: '18:00:00',
                    events: {
                        googleCalendarId: "fjsldvorxhfl@gmail.com",
                        googleCalendarApiKey: API_KEY
                    }
                });
                calendar.render();
            }

            gapi.load("client:auth2", initClient);
        });
    </script>

    <script async defer src="https://apis.google.com/js/api.js" onload="loadGapi()"></script>
</body>
</html>
